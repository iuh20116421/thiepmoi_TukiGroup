<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Thiệp mời TukiGroup</title>
    <link rel="icon" type="image/png" href="image/logoTrinhDuyet.png">
    <link rel="stylesheet" href="style.css">
    <!-- TỐI ƯU: Preload font để cải thiện performance -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:100,300,400,700,900&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Roboto:100,300,400,700,900&display=swap" rel="stylesheet"></noscript>
    <style>
        /* Đảm bảo hiệu ứng ngôi sao và sóng nước hiển thị */
        .star-effect {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            pointer-events: none !important;
            z-index: 1 !important;
            background: 
                radial-gradient(3px 3px at 25px 35px, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 50%, transparent 100%),
                radial-gradient(2px 2px at 85px 125px, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.08) 60%, transparent 100%),
                radial-gradient(4px 4px at 145px 85px, rgba(255,255,255,0.35) 0%, rgba(255,255,255,0.12) 40%, transparent 100%),
                radial-gradient(2.5px 2.5px at 205px 175px, rgba(255,255,255,0.28) 0%, rgba(255,255,255,0.09) 55%, transparent 100%),
                radial-gradient(3.5px 3.5px at 265px 125px, rgba(255,255,255,0.32) 0%, rgba(255,255,255,0.11) 45%, transparent 100%),
                radial-gradient(2px 2px at 325px 215px, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.07) 65%, transparent 100%),
                radial-gradient(4.5px 4.5px at 385px 165px, rgba(255,255,255,0.38) 0%, rgba(255,255,255,0.13) 35%, transparent 100%),
                radial-gradient(2.8px 2.8px at 445px 255px, rgba(255,255,255,0.26) 0%, rgba(255,255,255,0.08) 58%, transparent 100%),
                radial-gradient(3.2px 3.2px at 505px 195px, rgba(255,255,255,0.29) 0%, rgba(255,255,255,0.10) 50%, transparent 100%),
                radial-gradient(2.3px 2.3px at 565px 285px, rgba(255,255,255,0.24) 0%, rgba(255,255,255,0.07) 62%, transparent 100%);
            background-repeat: repeat !important;
            background-size: 600px 400px !important;
            animation: sparkle 30s linear infinite !important;
            opacity: 0.6 !important;
            filter: blur(0.3px) !important;
            display: block !important;
            visibility: visible !important;
        }

        .wave-effect {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 50% !important;
            height: 100% !important;
            pointer-events: none !important;
            z-index: 1 !important;
            background: 
                radial-gradient(ellipse 300px 80px at 15% 20%, rgba(64, 156, 255, 0.15) 0%, rgba(64, 156, 255, 0.08) 30%, transparent 60%),
                radial-gradient(ellipse 250px 60px at 35% 40%, rgba(100, 181, 246, 0.12) 0%, rgba(100, 181, 246, 0.06) 40%, transparent 70%),
                radial-gradient(ellipse 200px 50px at 55% 60%, rgba(144, 202, 249, 0.10) 0%, rgba(144, 202, 249, 0.05) 35%, transparent 65%),
                radial-gradient(ellipse 180px 45px at 75% 80%, rgba(179, 229, 252, 0.08) 0%, rgba(179, 229, 252, 0.04) 45%, transparent 75%),
                radial-gradient(ellipse 220px 55px at 25% 85%, rgba(129, 212, 250, 0.09) 0%, rgba(129, 212, 250, 0.04) 50%, transparent 80%);
            animation: gentleWave 12s ease-in-out infinite !important;
            display: block !important;
            visibility: visible !important;
        }

        @keyframes sparkle {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        @keyframes waveRipple3D {
            0% { 
                transform: scale(1) rotate(0deg) translateZ(0px) translateX(0px) translateY(0px);
                opacity: 0.4;
                filter: blur(0px);
            }
            12% { 
                transform: scale(1.08) rotate(1deg) translateZ(5px) translateX(3px) translateY(-2px);
                opacity: 0.6;
                filter: blur(0.2px);
            }
            25% { 
                transform: scale(1.15) rotate(-1deg) translateZ(10px) translateX(-5px) translateY(3px);
                opacity: 0.5;
                filter: blur(0.4px);
            }
            38% { 
                transform: scale(1.12) rotate(2deg) translateZ(8px) translateX(2px) translateY(-4px);
                opacity: 0.7;
                filter: blur(0.1px);
            }
            50% { 
                transform: scale(1.18) rotate(-1.5deg) translateZ(12px) translateX(-3px) translateY(2px);
                opacity: 0.6;
                filter: blur(0.5px);
            }
            62% { 
                transform: scale(1.1) rotate(1.5deg) translateZ(7px) translateX(4px) translateY(-1px);
                opacity: 0.8;
                filter: blur(0.3px);
            }
            75% { 
                transform: scale(1.2) rotate(-2deg) translateZ(15px) translateX(-2px) translateY(4px);
                opacity: 0.5;
                filter: blur(0.6px);
            }
            87% { 
                transform: scale(1.05) rotate(0.5deg) translateZ(3px) translateX(1px) translateY(-1px);
                opacity: 0.9;
                filter: blur(0.1px);
            }
            100% { 
                transform: scale(1) rotate(0deg) translateZ(0px) translateX(0px) translateY(0px);
                opacity: 0.4;
                filter: blur(0px);
            }
        }

        @keyframes gentleWave {
            0% {
                transform: translateY(0px);
                opacity: 0.3;
            }
            25% {
                transform: translateY(-6px);
                opacity: 0.5;
            }
            50% {
                transform: translateY(-12px);
                opacity: 0.4;
            }
            75% {
                transform: translateY(-6px);
                opacity: 0.6;
            }
            100% {
                transform: translateY(0px);
                opacity: 0.3;
            }
        }

        /* Ẩn ngôi sao và gợn sóng trong khu vực canvas-container */
        .canvas-container {
            position: relative;
            z-index: 2;
        }

        /* Ẩn hiệu ứng sao và gợn sóng trong canvas-container */
        .canvas-container .star-effect,
        .canvas-container .wave-effect {
            display: none !important;
        }

        /* Tạo mask để ẩn hiệu ứng trong canvas-container */
        .canvas-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #480101 100%);
            z-index: 1;
            pointer-events: none;
        }

        .canvas-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #480101 100%);
            z-index: -1;
            pointer-events: none;
        }

        /* Responsive cho mobile */
        @media (max-width: 768px) {
            .star-effect {
                background-size: 600px 400px !important;
                animation: sparkle 40s linear infinite !important;
                opacity: 0.2 !important;
            }
            
            .wave-effect {
                width: 0% !important;
                display: none !important;
            }
            
            #container {
                flex-direction: column !important;
                padding: 10px !important;
            }
            
            .left-panel, .right-panel {
                width: 100% !important;
                max-width: 100% !important;
            }
            
                         .left-panel {
                 order: 1 !important;
                 margin-bottom: 20px !important;
             }
             
             .right-panel {
                 order: 2 !important;
                 margin-bottom: 20px !important;
             }
            
            .canvas-container {
                display: flex !important;
                justify-content: center !important;
                align-items: center !important;
            }
            
            #invitationCanvas {
                width: 100% !important;
                max-width: 350px !important;
                height: auto !important;
            }
            
            .form-container {
                padding: 15px !important;
            }
            
            .form-group {
                margin-bottom: 15px !important;
            }
            
            .form-input {
                font-size: 16px !important;
                padding: 12px !important;
            }
            
            .generate-btn, .download-btn, .instructions-btn {
                width: 100% !important;
                padding: 15px !important;
                font-size: 16px !important;
                margin-bottom: 10px !important;
            }
            
            .modal-content {
                width: 95% !important;
                max-width: 400px !important;
                margin: 20px auto !important;
                padding: 20px !important;
            }
            
            .welcome-modal-content {
                max-height: 90vh !important;
                overflow-y: auto !important;
            }
            
            .welcome-content {
                flex-direction: column !important;
            }
            
            .frame-preview {
                width: 100% !important;
                margin-bottom: 20px !important;
            }
            
            .frame-image {
                width: 100% !important;
                height: auto !important;
            }
            
            .instruction-steps {
                width: 100% !important;
            }
            
            .step {
                margin-bottom: 15px !important;
                padding: 10px !important;
            }
            
            .photo-modal {
                width: 95% !important;
                max-width: 350px !important;
            }
            
            #cropCanvas {
                width: 100% !important;
                max-width: 250px !important;
                height: auto !important;
            }
            
            .crop-controls {
                padding: 10px !important;
            }
            
            .crop-buttons {
                flex-direction: column !important;
                gap: 10px !important;
            }
            
            .crop-buttons button {
                width: 100% !important;
                padding: 12px !important;
            }
        }

        /* Responsive cho tablet */
        @media (min-width: 769px) and (max-width: 1024px) {
            .star-effect {
                background-size: 500px 350px !important;
                animation: sparkle 25s linear infinite !important;
                opacity: 0.5 !important;
            }
            
            .wave-effect {
                width: 45% !important;
                animation: waveRipple3D 16s ease-in-out infinite !important;
            }
            
            #container {
                padding: 15px !important;
            }
            
            .left-panel, .right-panel {
                width: 48% !important;
            }
            
            #invitationCanvas {
                width: 100% !important;
                max-width: 500px !important;
                height: auto !important;
            }
            
            .form-container {
                padding: 20px !important;
            }
            
            .modal-content {
                width: 90% !important;
                max-width: 600px !important;
            }
        }
    </style>
</head>
<body>
    <!-- Hiệu ứng ngôi sao và sóng nước -->
    <div class="star-effect"></div>
    <div class="wave-effect"></div>
    
    <!-- Test hiệu ứng ngôi sao và sóng nước -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; background: radial-gradient(3px 3px at 25px 35px, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 50%, transparent 100%), radial-gradient(2px 2px at 85px 125px, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.08) 60%, transparent 100%), radial-gradient(4px 4px at 145px 85px, rgba(255,255,255,0.35) 0%, rgba(255,255,255,0.12) 40%, transparent 100%), radial-gradient(2.5px 2.5px at 205px 175px, rgba(255,255,255,0.28) 0%, rgba(255,255,255,0.09) 55%, transparent 100%), radial-gradient(3.5px 3.5px at 265px 125px, rgba(255,255,255,0.32) 0%, rgba(255,255,255,0.11) 45%, transparent 100%), radial-gradient(2px 2px at 325px 215px, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.07) 65%, transparent 100%), radial-gradient(4.5px 4.5px at 385px 165px, rgba(255,255,255,0.38) 0%, rgba(255,255,255,0.13) 35%, transparent 100%), radial-gradient(2.8px 2.8px at 445px 255px, rgba(255,255,255,0.26) 0%, rgba(255,255,255,0.08) 58%, transparent 100%), radial-gradient(3.2px 3.2px at 505px 195px, rgba(255,255,255,0.29) 0%, rgba(255,255,255,0.10) 50%, transparent 100%), radial-gradient(2.3px 2.3px at 565px 285px, rgba(255,255,255,0.24) 0%, rgba(255,255,255,0.07) 62%, transparent 100%); background-repeat: repeat; background-size: 600px 400px; animation: sparkle 30s linear infinite; opacity: 0.6; filter: blur(0.3px);"></div>
         <div style="position: fixed; top: 0; left: 0; width: 50%; height: 100%; pointer-events: none; z-index: 1; background: radial-gradient(ellipse 300px 80px at 15% 20%, rgba(64, 156, 255, 0.15) 0%, rgba(64, 156, 255, 0.08) 30%, transparent 60%), radial-gradient(ellipse 250px 60px at 35% 40%, rgba(100, 181, 246, 0.12) 0%, rgba(100, 181, 246, 0.06) 40%, transparent 70%), radial-gradient(ellipse 200px 50px at 55% 60%, rgba(144, 202, 249, 0.10) 0%, rgba(144, 202, 249, 0.05) 35%, transparent 65%), radial-gradient(ellipse 180px 45px at 75% 80%, rgba(179, 229, 252, 0.08) 0%, rgba(179, 229, 252, 0.04) 45%, transparent 75%), radial-gradient(ellipse 220px 55px at 25% 85%, rgba(129, 212, 250, 0.09) 0%, rgba(129, 212, 250, 0.04) 50%, transparent 80%); animation: gentleWave 12s ease-in-out infinite; opacity: 0.4;"></div>
    
    <div id="container">
        <!-- Bên trái - Biểu mẫu -->
        <div class="left-panel">
            <div class="logo">
                <!-- TỐI ƯU: Thêm lazy loading cho logo -->
                <img src="image/logos.png" alt="AI E-COMMERCE REVOLUTION" loading="lazy">
            </div>
            
            <div class="form-container">
                <h2>TẠO THIỆP MỜI</h2>
                
                <div class="form-group" id="guestNameSection">
                    <label for="guestName">Tên hiển thị trên thiệp mời <span style="color: #ff4444;">*</span></label>
                    <input type="text" id="guestName" placeholder="Nhập họ và tên" class="form-input" required>
                </div>
                
                

                
                <div class="form-group">
                    <label>Chọn hạng vé</label>
					<!-- Hidden native select for accessibility and logic -->
					<select id="ticketType" class="form-input select-input hidden-select" tabindex="-1" aria-hidden="true">
						<option value="Silver">SILVER</option>
						<option value="Gold">GOLD</option>
						<option value="Diamond">DIAMOND</option>
					</select>
					<!-- Custom dropdown UI -->
					<div class="dropdown" id="ticketDropdown">
						<button type="button" class="dropdown-toggle" aria-haspopup="listbox" aria-expanded="false" title="SILVER">
							<span class="dropdown-label">SILVER</span>
						</button>
						<ul class="dropdown-menu" role="listbox">
							<li class="dropdown-option" data-value="Silver" data-short="Silver" data-long="SILVER" role="option" aria-selected="true" title="VÉ">SILVER</li>
							<li class="dropdown-option" data-value="Gold" data-short="Gold" data-long="GOLD" role="option" title="GOLD">GOLD</li>
							<li class="dropdown-option" data-value="Diamond" data-short="Diamond" data-long="DIAMOND" role="option" title="DIAMOND">DIAMOND</li>
						</ul>
					</div>
                </div>
                
                <button id="generateInvitation" class="generate-btn">Tải ảnh lên</button>
            </div>
        </div>
        
        <!-- Bên phải - Xem trước canvas -->
        <div class="right-panel">
            <div class="canvas-container">
                <canvas id="invitationCanvas" width="2500" height="2500"></canvas>
            </div>
            
            <button id="downloadInvitation" class="download-btn">Tải thiệp mời</button>
            
            <!-- Nút mở hướng dẫn -->
            <button id="showInstructions" class="instructions-btn">Hướng dẫn tạo thiệp mời</button>
            
            <div class="footer-info">
                <p>Bản quyền thuộc về TukiGroup</p>
            </div>
        </div>
    </div>
    
    <!-- Các cửa sổ (modal) -->
    <!-- Cửa sổ chào mừng + hướng dẫn -->
    <div id="welcomeModal" class="modal " style="display: none;">
        <div class="modal-content welcome-modal-content">
            <span class="close" id="closeWelcomeModal">&times;</span>
            <h2>Hướng dẫn tạo thiệp mời sự kiện!</h2>
            
            <div class="welcome-content">
                <div class="frame-preview">
                    <!-- TỐI ƯU: Thêm lazy loading cho ảnh mẫu -->
                    <img src="image/frameEventChiBinh.jpg" alt="Thiệp mời mẫu" class="frame-image" loading="lazy">
                </div>
                
                <div class="instruction-steps">
                    <div class="step" data-step="1">
                        <div class="step-number">1</div>
                        <p>Điền thông tin và tải ảnh bản thân lên.</p>
                    </div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <p>Điều chỉnh vị trí và kích thước ảnh theo ý muốn.</p>
                    </div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <p>Nhấn tải thiệp mời về máy.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Cửa sổ chỉnh sửa ảnh -->
    <div id="photoModal" class="modal" style="display: none;">
        <div class="modal-content photo-modal">
            <span class="close">&times;</span>
            <h2>Chọn ảnh đại diện</h2>
            <div class="photo-upload-area">
                <input type="file" id="photoInput" accept="image/*" style="display: none;">
                <div id="photoPreview" class="photo-preview">
                    <canvas id="cropCanvas" width="300" height="300"></canvas>
                    <div class="crop-controls">
                        <p>Dùng thanh cuộn để thu phóng ảnh và kéo ảnh lên/xuống/trái/phải tới vị trí bạn muốn</p>
                        <input type="range" id="scaleSlider" min="0.5" max="3" step="0.1" value="1">
                        <div class="crop-buttons">
                            <button id="cancelCrop" class="cancel-btn">Hủy</button>
                            <button id="saveCrop" class="save-btn">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>